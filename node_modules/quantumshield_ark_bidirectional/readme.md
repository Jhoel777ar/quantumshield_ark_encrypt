# QuantumShield Ark Bidirectional

[![npm version](https://img.shields.io/npm/v/quantumshield_ark_bidirectional)](https://www.npmjs.com/package/quantumshield_ark_bidirectional)
[![TypeScript](https://img.shields.io/badge/TypeScript-Supported-blue)](https://www.typescriptlang.org/)
[![License: GPL-3.0](https://img.shields.io/badge/License-GPL--3.0-green)](https://opensource.org/licenses/GPL-3.0)
[![WebAssembly](https://img.shields.io/badge/WebAssembly-Optimized-orange)](https://webassembly.org/)

**QuantumShield Ark Bidirectional** es una librer√≠a WebAssembly de alta seguridad para encriptaci√≥n y desencriptaci√≥n bidireccional, con resistencia parcial a ataques cu√°nticos. Dise√±ada para aplicaciones web que demandan criptograf√≠a robusta y de grado militar.

---

## üöÄ Caracter√≠sticas

- **üîê Dos Modos de Encriptaci√≥n**:
  - **Modo Standard** (`wasm_encrypt`): R√°pido y eficiente para uso general
  - **Modo PRO** (`wasm_encrypt_pro`): Cifrado de grado militar con capas de seguridad adicionales
  
- **üõ°Ô∏è Resistencia Post-Cu√°ntica Parcial**: Sistema de 8192 rondas para protecci√≥n contra ataques cu√°nticos (algoritmo de Shor)

- **‚ö° WebAssembly Optimizado**: Binario ligero (~400 KB) para m√°ximo rendimiento

- **üîë Arquitectura Zero-Knowledge**: 
  - ‚ùå El desarrollador NO conoce las claves generadas
  - ‚ùå Terceros NO pueden reconstruir datos desde el hash
  - ‚úÖ Sistema determinista y verificable

- **üéØ API Simple**: F√°cil integraci√≥n en JavaScript/TypeScript

- **üì¶ L√≠mite de Texto**: Hasta 10 MB por mensaje

---

## üì• Instalaci√≥n

```bash
npm i quantumshield_ark_bidirectional
```

---

## üíª Uso

### API Disponible

La librer√≠a expone las siguientes funciones:

- `wasm_generate_keypair()`: Genera un par de claves (X25519 + Ed25519)
- `wasm_encrypt(plaintext, x25519_pub, ed25519_sec, seed)`: Encripta en modo Standard
- `wasm_encrypt_pro(plaintext, x25519_pub, ed25519_sec, seed)`: Encripta en modo PRO (grado militar)
- `wasm_decrypt(ciphertext, x25519_sec, ed25519_pub)`: Desencripta autom√°ticamente (detecta el modo)

---

### Ejemplo 1: Modo Standard (R√°pido)

```javascript
import init, { wasm_generate_keypair, wasm_encrypt, wasm_decrypt } from 'quantumshield_ark_bidirectional';

async function modoStandard() {
  // Inicializar WebAssembly
  await init();

  // Generar claves
  const keypair = wasm_generate_keypair();
  const x25519_pub = new Uint8Array(keypair.x25519_pub);
  const x25519_sec = new Uint8Array(keypair.x25519_sec);
  const ed25519_pub = new Uint8Array(keypair.ed25519_pub);
  const ed25519_sec = new Uint8Array(keypair.ed25519_sec);

  // Encriptar en modo Standard
  const plaintext = "Mensaje confidencial";
  const seed = new TextEncoder().encode("session_123");
  const ciphertext = wasm_encrypt(plaintext, x25519_pub, ed25519_sec, seed);
  
  console.log("Modo: STANDARD");
  console.log("Ciphertext (hex):", Array.from(ciphertext).map(b => b.toString(16).padStart(2, '0')).join(''));

  // Desencriptar (auto-detecta el modo)
  const decrypted = wasm_decrypt(ciphertext, x25519_sec, ed25519_pub);
  console.log("Decrypted:", decrypted);
}

modoStandard().catch(console.error);
```

---

### Ejemplo 2: Modo PRO (Grado Militar)

```javascript
import init, { wasm_generate_keypair, wasm_encrypt_pro, wasm_decrypt } from 'quantumshield_ark_bidirectional';

async function modoPRO() {
  await init();

  // Generar claves
  const keypair = wasm_generate_keypair();
  const x25519_pub = new Uint8Array(keypair.x25519_pub);
  const x25519_sec = new Uint8Array(keypair.x25519_sec);
  const ed25519_pub = new Uint8Array(keypair.ed25519_pub);
  const ed25519_sec = new Uint8Array(keypair.ed25519_sec);

  // Encriptar en modo PRO (m√°s seguro, m√°s lento)
  const plaintext = "Informaci√≥n militar clasificada";
  const seed = new TextEncoder().encode("secure_session_456");
  const ciphertext = wasm_encrypt_pro(plaintext, x25519_pub, ed25519_sec, seed);
  
  console.log("Modo: PRO (Military Grade)");
  console.log("Ciphertext (hex):", Array.from(ciphertext).map(b => b.toString(16).padStart(2, '0')).join(''));

  // Desencriptar (auto-detecta modo PRO)
  const decrypted = wasm_decrypt(ciphertext, x25519_sec, ed25519_pub);
  console.log("Decrypted:", decrypted);
}

modoPRO().catch(console.error);
```

---

### Ejemplo 3: Comparaci√≥n de Modos

```javascript
import init, { wasm_generate_keypair, wasm_encrypt, wasm_encrypt_pro, wasm_decrypt } from 'quantumshield_ark_bidirectional';

async function compararModos() {
  await init();

  const keypair = wasm_generate_keypair();
  const x25519_pub = new Uint8Array(keypair.x25519_pub);
  const x25519_sec = new Uint8Array(keypair.x25519_sec);
  const ed25519_pub = new Uint8Array(keypair.ed25519_pub);
  const ed25519_sec = new Uint8Array(keypair.ed25519_sec);

  const plaintext = "Texto de prueba para comparar modos";
  const seed = new TextEncoder().encode("test_seed");

  // Modo Standard
  console.time("Standard Mode");
  const ct_standard = wasm_encrypt(plaintext, x25519_pub, ed25519_sec, seed);
  console.timeEnd("Standard Mode");
  console.log("Standard Size:", ct_standard.length, "bytes");

  // Modo PRO
  console.time("PRO Mode");
  const ct_pro = wasm_encrypt_pro(plaintext, x25519_pub, ed25519_sec, seed);
  console.timeEnd("PRO Mode");
  console.log("PRO Size:", ct_pro.length, "bytes");

  // Desencriptar ambos
  const dec_standard = wasm_decrypt(ct_standard, x25519_sec, ed25519_pub);
  const dec_pro = wasm_decrypt(ct_pro, x25519_sec, ed25519_pub);

  console.log("Standard OK:", dec_standard === plaintext);
  console.log("PRO OK:", dec_pro === plaintext);
}

compararModos().catch(console.error);
```

---

### Ejemplo 4: Aplicaci√≥n Web Completa

```html
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuantumShield - Dos Modos</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); padding: 40px; }
    h1 { color: #667eea; text-align: center; margin-bottom: 10px; }
    .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
    .mode-selector { display: flex; gap: 15px; justify-content: center; margin-bottom: 30px; }
    .mode-btn { padding: 12px 30px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
    .mode-btn.active { background: #667eea; color: white; }
    .mode-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3); }
    .input-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; }
    input, textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; font-family: inherit; }
    textarea { min-height: 100px; resize: vertical; font-family: 'Courier New', monospace; }
    button { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; }
    button:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4); }
    .result { margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea; }
    .key-display { background: #f1f3f5; padding: 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 11px; word-break: break-all; margin: 8px 0; }
    .mode-info { padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    .mode-info.standard { background: #e3f2fd; border-left: 4px solid #2196f3; }
    .mode-info.pro { background: #fff3e0; border-left: 4px solid #ff9800; }
    .section-title { margin-top: 30px; padding-bottom: 10px; border-bottom: 2px solid #667eea; color: #667eea; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê QuantumShield Ark Bidirectional</h1>
    <p class="subtitle">Encriptaci√≥n de Grado Militar con Dos Modos</p>

    <div class="mode-selector">
      <button class="mode-btn active" id="btnStandard">‚ö° Modo Standard</button>
      <button class="mode-btn" id="btnPro">üõ°Ô∏è Modo PRO</button>
    </div>

    <div id="modeInfo" class="mode-info standard">
      <strong>Modo Standard:</strong> R√°pido y eficiente. Ideal para comunicaciones generales, chat, y transferencia de archivos.
    </div>

    <h3 class="section-title">Encriptar Mensaje</h3>
    <div class="input-group">
      <label>üìù Mensaje a Encriptar:</label>
      <textarea id="plaintext" placeholder="Escribe tu mensaje aqu√≠..."></textarea>
    </div>

    <div class="input-group">
      <label>üîë Seed (opcional):</label>
      <input type="text" id="seed" placeholder="Dejar vac√≠o para usar seed predeterminado">
    </div>

    <button id="encryptBtn">üîí Encriptar con <span id="modeLabel">Standard</span></button>

    <h3 class="section-title">Desencriptar Mensaje</h3>
    <div class="input-group">
      <label>üì¶ Ciphertext (hex):</label>
      <textarea id="ciphertext" placeholder="Pega aqu√≠ el texto encriptado en hexadecimal"></textarea>
    </div>

    <div class="input-group">
      <label>üîê X25519 Secret Key (hex):</label>
      <input type="text" id="x25519_sec" placeholder="Clave secreta X25519">
    </div>

    <div class="input-group">
      <label>üîì Ed25519 Public Key (hex):</label>
      <input type="text" id="ed25519_pub" placeholder="Clave p√∫blica Ed25519">
    </div>

    <button id="decryptBtn">üîì Desencriptar (Auto-detecta modo)</button>

    <div id="result"></div>
  </div>

  <script type="module">
    import init, { wasm_generate_keypair, wasm_encrypt, wasm_encrypt_pro, wasm_decrypt } 
      from './node_modules/quantumshield_ark_bidirectional/quantumshield.js';

    await init();

    let currentMode = 'standard';

    // Selector de modo
    document.getElementById('btnStandard').addEventListener('click', () => {
      currentMode = 'standard';
      document.getElementById('btnStandard').classList.add('active');
      document.getElementById('btnPro').classList.remove('active');
      document.getElementById('modeLabel').textContent = 'Standard';
      document.getElementById('modeInfo').className = 'mode-info standard';
      document.getElementById('modeInfo').innerHTML = '<strong>Modo Standard:</strong> R√°pido y eficiente. Ideal para comunicaciones generales, chat, y transferencia de archivos.';
    });

    document.getElementById('btnPro').addEventListener('click', () => {
      currentMode = 'pro';
      document.getElementById('btnPro').classList.add('active');
      document.getElementById('btnStandard').classList.remove('active');
      document.getElementById('modeLabel').textContent = 'PRO (Military Grade)';
      document.getElementById('modeInfo').className = 'mode-info pro';
      document.getElementById('modeInfo').innerHTML = '<strong>Modo PRO:</strong> M√°xima seguridad con capas adicionales. Procesamiento m√°s lento pero protecci√≥n de grado militar. Ideal para datos clasificados.';
    });

    function hexEncode(bytes) {
      return Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    function hexDecode(hex) {
      const bytes = new Uint8Array(hex.length / 2);
      for (let i = 0; i < hex.length; i += 2) {
        bytes[i / 2] = parseInt(hex.substr(i, 2), 16);
      }
      return bytes;
    }

    // Encriptar
    document.getElementById('encryptBtn').addEventListener('click', () => {
      const plaintext = document.getElementById('plaintext').value;
      const seed = document.getElementById('seed').value || 'default_seed_v5';
      const resultDiv = document.getElementById('result');

      if (!plaintext) {
        resultDiv.innerHTML = '<div class="result" style="border-left-color: #f44336;"><p style="color: #f44336;">‚ùå Por favor ingresa un mensaje</p></div>';
        return;
      }

      try {
        const keypair = wasm_generate_keypair();
        const x25519_pub = new Uint8Array(keypair.x25519_pub);
        const x25519_sec = new Uint8Array(keypair.x25519_sec);
        const ed25519_pub = new Uint8Array(keypair.ed25519_pub);
        const ed25519_sec = new Uint8Array(keypair.ed25519_sec);

        const startTime = performance.now();
        const ciphertext = currentMode === 'pro' 
          ? wasm_encrypt_pro(plaintext, x25519_pub, ed25519_sec, new TextEncoder().encode(seed))
          : wasm_encrypt(plaintext, x25519_pub, ed25519_sec, new TextEncoder().encode(seed));
        const endTime = performance.now();

        const modeIcon = currentMode === 'pro' ? 'üõ°Ô∏è' : '‚ö°';
        const modeName = currentMode === 'pro' ? 'PRO (Military Grade)' : 'STANDARD';

        resultDiv.innerHTML = `
          <div class="result">
            <h4>‚úÖ Encriptaci√≥n Exitosa - Modo ${modeIcon} ${modeName}</h4>
            <p><strong>‚è±Ô∏è Tiempo:</strong> ${(endTime - startTime).toFixed(2)} ms</p>
            <p><strong>üìä Tama√±o:</strong> ${plaintext.length} bytes ‚Üí ${ciphertext.length} bytes</p>
            <p><strong>üì¶ Ciphertext (hex):</strong></p>
            <div class="key-display">${hexEncode(ciphertext)}</div>
            <p><strong>üîë Claves (GU√ÅRDALAS DE FORMA SEGURA):</strong></p>
            <p><strong>X25519 Public:</strong></p>
            <div class="key-display">${hexEncode(x25519_pub)}</div>
            <p><strong>X25519 Secret:</strong></p>
            <div class="key-display">${hexEncode(x25519_sec)}</div>
            <p><strong>Ed25519 Public:</strong></p>
            <div class="key-display">${hexEncode(ed25519_pub)}</div>
            <p><strong>Ed25519 Secret:</strong></p>
            <div class="key-display">${hexEncode(ed25519_sec)}</div>
            <p style="color: #f44336; margin-top: 15px;">‚ö†Ô∏è <strong>IMPORTANTE:</strong> Copia y guarda estas claves. Sin ellas no podr√°s desencriptar el mensaje.</p>
          </div>
        `;
      } catch (e) {
        resultDiv.innerHTML = `<div class="result" style="border-left-color: #f44336;"><p style="color: #f44336;">‚ùå Error: ${e.message}</p></div>`;
      }
    });

    // Desencriptar
    document.getElementById('decryptBtn').addEventListener('click', () => {
      const ctHex = document.getElementById('ciphertext').value.trim();
      const x25519SecHex = document.getElementById('x25519_sec').value.trim();
      const ed25519PubHex = document.getElementById('ed25519_pub').value.trim();
      const resultDiv = document.getElementById('result');

      if (!ctHex || !x25519SecHex || !ed25519PubHex) {
        resultDiv.innerHTML = '<div class="result" style="border-left-color: #f44336;"><p style="color: #f44336;">‚ùå Por favor completa todos los campos</p></div>';
        return;
      }

      try {
        const ciphertext = hexDecode(ctHex);
        const x25519_sec = hexDecode(x25519SecHex);
        const ed25519_pub = hexDecode(ed25519PubHex);

        // Auto-detectar modo
        const detectedMode = (!ciphertext || ciphertext.length === 0) ? 'UNKNOWN' : 
                            (ciphertext[0] === 0x01) ? 'PRO' : 'STANDARD';
        const modeIcon = detectedMode === 'PRO' ? 'üõ°Ô∏è' : '‚ö°';

        const startTime = performance.now();
        const plaintext = wasm_decrypt(ciphertext, x25519_sec, ed25519_pub);
        const endTime = performance.now();

        resultDiv.innerHTML = `
          <div class="result">
            <h4>‚úÖ Desencriptaci√≥n Exitosa</h4>
            <p><strong>üìä Modo Detectado:</strong> ${modeIcon} ${detectedMode}</p>
            <p><strong>‚è±Ô∏è Tiempo:</strong> ${(endTime - startTime).toFixed(2)} ms</p>
            <p><strong>üìù Mensaje Desencriptado:</strong></p>
            <div class="key-display" style="font-size: 14px; white-space: pre-wrap;">${plaintext}</div>
          </div>
        `;
      } catch (e) {
        resultDiv.innerHTML = `<div class="result" style="border-left-color: #f44336;"><p style="color: #f44336;">‚ùå Error al desencriptar: ${e.message}</p><p>Verifica que las claves y el ciphertext sean correctos.</p></div>`;
      }
    });
  </script>
</body>
</html>
```

---

## üîí Diferencias entre Modos

| Caracter√≠stica | Modo Standard | Modo PRO |
|----------------|---------------|----------|
| **Velocidad** | ‚ö° R√°pido | üê¢ M√°s lento |
| **Seguridad** | üõ°Ô∏è Alta | üõ°Ô∏èüõ°Ô∏èüõ°Ô∏è M√°xima (Grado Militar) |
| **Uso recomendado** | Comunicaciones generales | Datos clasificados |
| **Capas de seguridad** | Est√°ndar (8192 rondas) | Adicionales reforzadas |
| **Overhead** | Moderado | Mayor |
| **Funci√≥n** | `wasm_encrypt()` | `wasm_encrypt_pro()` |
| **Desencriptaci√≥n** | `wasm_decrypt()` (auto-detecta) | `wasm_decrypt()` (auto-detecta) |

---

## üõ°Ô∏è Arquitectura de Seguridad

### Primitivas Criptogr√°ficas
- **X25519**: Intercambio de claves ECDH
- **Ed25519**: Firmas digitales
- **ChaCha20-Poly1305**: Cifrado AEAD
- **Argon2id**: Derivaci√≥n de claves resistente a memoria
- **SHA-512**: Hash criptogr√°fico
- **Sistema de 8192 rondas**: Fortalecimiento contra ataques cu√°nticos

### Protecci√≥n Contra
- ‚úÖ Ataques cu√°nticos (Algoritmo de Shor)
- ‚úÖ Fuerza bruta
- ‚úÖ Man-in-the-middle
- ‚úÖ Ataques de repetici√≥n
- ‚úÖ Falsificaci√≥n y manipulaci√≥n
- ‚úÖ Ataques de canal lateral

### Sistema Zero-Knowledge
- ‚ùå El desarrollador NO conoce las claves generadas
- ‚ùå Terceros NO pueden reconstruir datos desde los hashes
- ‚úÖ Sistema completamente determinista
- ‚úÖ Verificaci√≥n sin exposici√≥n de datos sensibles

---

## ‚úÖ Verificaci√≥n de Integridad

Para verificar la autenticidad del paquete:

### Windows (PowerShell)
```powershell
Get-FileHash .\node_modules\quantumshield_ark_bidirectional\quantumshield_bg.wasm -Algorithm SHA256
```

### Linux/macOS
```bash
sha256sum ./node_modules/quantumshield_ark_bidirectional/quantumshield_bg.wasm
```

**Hash SHA-256 esperado:**
```
F13438A4B4AA1C7E95166B289587DA7CC220ABE34CE347006FECC98D4D630A61
```

---

## üîë Firma GPG

Este paquete est√° firmado digitalmente:

```
-----BEGIN PGP PUBLIC KEY BLOCK-----

mDMEaObWNRYJKwYBBAHaRw8BAQdAf87vhKNai/1p+NeR7M5K7cGngGmDfZ2y9LLH
Vo5EUpe0JkFSSyBERVYgT1JHIDxhbmRyZXVzamhvZWw2N0BnbWFpbC5jb20+iJkE
ExYKAEEWIQR/6rX+fobsa1a+4KA9Jr7YZMQo2AUCaObWNQIbAwUJBaSgSwULCQgH
AgIiAgYVCgkICwIEFgIDAQIeBwIXgAAKCRA9Jr7YZMQo2LMrAQC5j0guLlj7hLYY
y9I2C75GGvJS2IjVmsezRcwZCgSQIgD/fBdZ/+EXTl86TP6kNxL+MYXYz0gQeb3h
zTzV/nllbAu4OARo5tY1EgorBgEEAZdVAQUBAQdA+S9ATbySGDOU34OOyolgF43r
b5O/tEUxbCqI8DFpWXcDAQgHiH4EGBYKACYWIQR/6rX+fobsa1a+4KA9Jr7YZMQo
2AUCaObWNQIbDAUJBaSgSwAKCRA9Jr7YZMQo2GBmAQCpPuvET16U8Y9sGIo1V5yb
p7OkrXsTl1tZTpguAex4KQD+OMMgW8SBKV7sK3zRNnMdjoMrzRyAim0unrTLAIRE
6gM=
=Y5IQ
-----END PGP PUBLIC KEY BLOCK-----
```

---

## üìã Requisitos

- **Node.js** v14 o superior
- **Navegador moderno** con WebAssembly:
  - Chrome 57+
  - Firefox 52+
  - Safari 11+
  - Edge 16+

---

## üåç Casos de Uso

### Modo Standard
- ‚úâÔ∏è Mensajer√≠a instant√°nea
- üí¨ Aplicaciones de chat
- üìÅ Transferencia de archivos
- üåê Comunicaciones web est√°ndar

### Modo PRO
- üèõÔ∏è Comunicaciones gubernamentales
- üè• Datos m√©dicos sensibles
- üí∞ Sistemas financieros cr√≠ticos
- üéñÔ∏è Informaci√≥n militar clasificada
- üîê Almacenamiento de alto valor

---

## üìä Especificaciones T√©cnicas

| Caracter√≠stica | Valor |
|---------------|-------|
| Tama√±o del binario | ~400 KB |
| L√≠mite de mensaje | 10 MB |
| Rondas de fortalecimiento | 8192 |
| Curvas el√≠pticas | X25519, Ed25519 |
| Cifrado AEAD | ChaCha20-Poly1305 |
| KDF | Argon2id |

---

## ‚ö†Ô∏è Advertencias de Seguridad

1. **NO modifiques el c√≥digo fuente** - Cualquier alteraci√≥n compromete la seguridad
2. **Verifica el hash SHA-256** del binario WASM antes de usar en producci√≥n
3. **Guarda las claves de forma segura** - Sin ellas no podr√°s desencriptar
4. **Usa Modo PRO** para datos altamente sensibles o clasificados
5. **El Modo PRO es m√°s lento** debido a las capas adicionales de seguridad

---

## üìû Soporte

- **GitHub Issues**: [Reportar problemas](https://github.com/tu-repo/quantumshield/issues)
- **Email**: ark_dev@hotmail.com

---

## üìú Licencia

GPL-3.0 - Ver [LICENSE](LICENSE) para m√°s detalles.

---

## üôè Agradecimientos

Desarrollado para proporcionar seguridad de grado militar en aplicaciones web modernas.

**Dise√±ado para un mundo de alta protecci√≥n** üîí